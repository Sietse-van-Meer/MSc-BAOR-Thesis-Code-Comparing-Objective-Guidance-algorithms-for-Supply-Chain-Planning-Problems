from numba import njit
import numpy as np
import time

@njit(cache=True)
def calculate_load_at_time(jobs, max_time):
    load_at_time = np.zeros(max_time + 1, dtype=np.int32)
    for job in jobs:
        start, duration, weight = job['start_time'], job['processing_time'], job['weight']
        load_at_time[start:start + duration] += weight
    return load_at_time

@njit(cache=True)
def adjust_load(load_at_time, job, new_start, old_start):
    duration = job['processing_time']
    weight = job['weight']
    if new_start != old_start:
        load_at_time[old_start:old_start + duration] -= weight
        load_at_time[new_start:new_start + duration] += weight

@njit(cache=True)
def calculate_total_overload(load_at_time, c_t):
    overload = np.sum(np.maximum(0, load_at_time - c_t))
    return overload

@njit(cache=True)
def calculate_objective_value(total_overload, total_tardiness):
    return 10 * total_overload + total_tardiness

@njit(cache=True)
def is_within_constraints(job, new_start):
    job_end = new_start + job['processing_time']
    lower_bound = job['due_date'] - job['lower_bound']
    upper_bound = job['due_date'] + job['upper_bound']
    return lower_bound <= job_end <= upper_bound

@njit(cache=True)
def evaluate_move(load_at_time, job, new_start, old_start, c_t, total_tardiness):
    duration = job['processing_time']
    weight = job['weight']
    max_time = len(load_at_time) - 1

    # Temporarily adjust load for the new start
    for t in range(new_start, min(new_start + duration, max_time + 1)):
        load_at_time[t] += weight
    for t in range(old_start, min(old_start + duration, max_time + 1)):
        load_at_time[t] -= weight

    # Calculate the new overload and objective
    new_overload = calculate_total_overload(load_at_time, c_t)
    new_tardiness = max(0, new_start + duration - job['due_date'])
    delta_tardiness = new_tardiness - max(0, old_start + duration - job['due_date'])
    new_objective = calculate_objective_value(new_overload, total_tardiness + delta_tardiness)

    # Revert the temporary adjustment
    for t in range(new_start, min(new_start + duration, max_time + 1)):
        load_at_time[t] -= weight
    for t in range(old_start, min(old_start + duration, max_time + 1)):
        load_at_time[t] += weight

    return new_objective, new_overload, delta_tardiness


@njit(cache=True)
def simplified_random_local_search(jobs, c_t, max_time, max_iterations, seed_value):
    np.random.seed(seed_value)
    current_solution = jobs.copy()
    load_at_time = calculate_load_at_time(current_solution, max_time)
    tardiness_values = np.array([max(0, job['start_time'] + job['processing_time'] - job['due_date']) for job in current_solution], dtype=np.int32)
    total_tardiness = np.sum(tardiness_values)
    total_overload = calculate_total_overload(load_at_time, c_t)
    current_objective = calculate_objective_value(total_overload, total_tardiness)

    job_indices = np.arange(len(jobs))
    all_shifts = np.arange(-80, 81)

    iteration = 0  # Initialize iteration counter

    while iteration < max_iterations:  # Only stop based on max_iterations

        # Pick a random job and a random shift
        job_index = np.random.choice(job_indices)
        job = current_solution[job_index]
        old_start = job['start_time']
        shift = np.random.choice(all_shifts)
        
        if shift == 0:
            continue
        
        new_start = old_start + shift
        
        if 0 <= new_start <= max_time - job['processing_time'] and is_within_constraints(job, new_start):
            new_objective, new_overload, delta_tardiness = evaluate_move(
                load_at_time, job, new_start, old_start, c_t, total_tardiness
            )
            iteration += 1  # Increment iteration count

            if new_objective < current_objective:  # Accept if the move is equal or better
                # Make the move
                adjust_load(load_at_time, job, new_start, old_start)
                current_solution[job_index]['start_time'] = new_start
                tardiness_values[job_index] += delta_tardiness
                total_tardiness += delta_tardiness
                total_overload = new_overload
                current_objective = new_objective

    return current_objective

def main():
    Job = np.dtype([('id', np.int32), ('processing_time', np.int32), ('weight', np.int32),
                ('due_date', np.int32), ('start_time', np.int32), ('lower_bound', np.int32),
                ('upper_bound', np.int32)])
    jobs = np.array([(1, 51, 51, 622, 500, 80, 160), (2, 82, 82, 253, 129, 80, 160), (3, 43, 43, 611, 569, 80, 160), (4, 76, 76, 879, 777, 80, 160), (5, 146, 146, 742, 743, 80, 160), (6, 141, 141, 144, 67, 80, 160), (7, 60, 60, 447, 364, 80, 160), (8, 132, 132, 956, 859, 80, 160), (9, 53, 53, 291, 199, 80, 160), (10, 111, 111, 870, 892, 80, 160), (11, 145, 145, 205, 3, 80, 160), (12, 44, 44, 140, 207, 80, 160), (13, 60, 60, 879, 762, 80, 160), (14, 63, 63, 734, 749, 80, 160), (15, 133, 133, 3, 17, 80, 160), (16, 92, 92, 281, 307, 80, 160), (17, 134, 134, 407, 305, 80, 160), (18, 95, 95, 1021, 869, 80, 160), (19, 158, 158, 990, 905, 80, 160), (20, 111, 111, 241, 262, 80, 160), (21, 51, 51, 980, 1032, 80, 160), (22, 135, 135, 574, 384, 80, 160), (23, 48, 48, 953, 828, 80, 160), (24, 149, 149, 346, 354, 80, 160), (25, 41, 41, 356, 296, 80, 160), (26, 87, 87, 485, 427, 80, 160), (27, 149, 149, 873, 870, 80, 160), (28, 83, 83, 772, 617, 80, 160), (29, 99, 99, 372, 353, 80, 160), (30, 108, 108, 152, 7, 80, 160), (31, 93, 93, 734, 786, 80, 160), (32, 41, 41, 142, 165, 80, 160), (33, 109, 109, 854, 683, 80, 160), (34, 160, 160, 644, 531, 80, 160), (35, 80, 80, 819, 885, 80, 160), (36, 149, 149, 399, 175, 80, 160), (37, 159, 159, 158, 155, 80, 160), (38, 79, 79, 625, 610, 80, 160), (39, 91, 91, 509, 420, 80, 160), (40, 111, 111, 191, 134, 80, 160), (41, 121, 121, 47, 12, 80, 160), (42, 85, 85, 1024, 1000, 80, 160), (43, 141, 141, 581, 582, 80, 160), (44, 132, 132, 631, 610, 80, 160), (45, 85, 85, 293, 340, 80, 160), (46, 125, 125, 198, 181, 80, 160), (47, 152, 152, 616, 552, 80, 160), (48, 79, 79, 948, 800, 80, 160), (49, 136, 136, 53, 43, 80, 160), (50, 146, 146, 977, 951, 80, 160), (51, 58, 58, 638, 707, 80, 160), (52, 59, 59, 61, 155, 80, 160), (53, 128, 128, 694, 618, 80, 160), (54, 121, 121, 136, 55, 80, 160), (55, 92, 92, 3, 5, 80, 160), (56, 99, 99, 80, 131, 80, 160), (57, 92, 92, 427, 426, 80, 160), (58, 67, 67, 427, 320, 80, 160), (59, 148, 148, 592, 539, 80, 160), (60, 125, 125, 241, 114, 80, 160), (61, 73, 73, 362, 345, 80, 160), (62, 83, 83, 927, 805, 80, 160), (63, 143, 143, 541, 338, 80, 160), (64, 93, 93, 67, 26, 80, 160), (65, 155, 155, 671, 567, 80, 160), (66, 52, 52, 784, 864, 80, 160), (67, 97, 97, 924, 982, 80, 160), (68, 74, 74, 781, 808, 80, 160), (69, 85, 85, 496, 368, 80, 160), (70, 96, 96, 780, 618, 80, 160), (71, 130, 130, 346, 149, 80, 160), (72, 148, 148, 956, 844, 80, 160), (73, 142, 142, 511, 424, 80, 160), (74, 126, 126, 698, 584, 80, 160), (75, 160, 160, 734, 544, 80, 160), (76, 154, 154, 254, 72, 80, 160), (77, 108, 108, 397, 326, 80, 160), (78, 113, 113, 748, 576, 80, 160), (79, 146, 146, 988, 950, 80, 160), (80, 46, 46, 895, 970, 80, 160), (81, 129, 129, 517, 331, 80, 160), (82, 43, 43, 725, 675, 80, 160), (83, 50, 50, 813, 803, 80, 160), (84, 90, 90, 216, 145, 80, 160), (85, 153, 153, 11, 7, 80, 160), (86, 97, 97, 631, 614, 80, 160), (87, 64, 64, 442, 319, 80, 160), (88, 58, 58, 739, 670, 80, 160), (89, 56, 56, 394, 383, 80, 160), (90, 157, 157, 722, 698, 80, 160), (91, 95, 95, 782, 703, 80, 160), (92, 46, 46, 594, 478, 80, 160), (93, 105, 105, 877, 711, 80, 160), (94, 128, 128, 980, 985, 80, 160), (95, 88, 88, 314, 309, 80, 160), (96, 66, 66, 442, 332, 80, 160), (97, 109, 109, 387, 212, 80, 160), (98, 150, 150, 158, 67, 80, 160), (99, 113, 113, 784, 818, 80, 160), (100, 48, 48, 772, 816, 80, 160), (101, 65, 65, 424, 383, 80, 160), (102, 85, 85, 500, 477, 80, 160), (103, 71, 71, 277, 154, 80, 160), (104, 66, 66, 648, 540, 80, 160), (105, 113, 113, 485, 436, 80, 160), (106, 78, 78, 631, 687, 80, 160), (107, 46, 46, 644, 582, 80, 160), (108, 59, 59, 253, 347, 80, 160), (109, 118, 118, 28, 69, 80, 160), (110, 146, 146, 784, 780, 80, 160), (111, 159, 159, 253, 182, 80, 160), (112, 111, 111, 304, 261, 80, 160), (113, 141, 141, 801, 796, 80, 160), (114, 68, 68, 948, 975, 80, 160), (115, 100, 100, 832, 683, 80, 160), (116, 131, 131, 834, 839, 80, 160), (117, 41, 41, 60, 169, 80, 160), (118, 144, 144, 142, 131, 80, 160), (119, 123, 123, 734, 760, 80, 160), (120, 72, 72, 442, 331, 80, 160), (121, 45, 45, 531, 592, 80, 160), (122, 49, 49, 600, 550, 80, 160), (123, 98, 98, 397, 286, 80, 160), (124, 89, 89, 542, 436, 80, 160), (125, 154, 154, 727, 496, 80, 160), (126, 103, 103, 768, 816, 80, 160), (127, 45, 45, 648, 592, 80, 160), (128, 119, 119, 783, 631, 80, 160), (129, 107, 107, 325, 203, 80, 160), (130, 133, 133, 727, 624, 80, 160), (131, 123, 123, 783, 740, 80, 160), (132, 82, 82, 1001, 913, 80, 160), (133, 75, 75, 1034, 1042, 80, 160), (134, 110, 110, 629, 465, 80, 160), (135, 132, 132, 574, 578, 80, 160), (136, 146, 146, 401, 224, 80, 160), (137, 86, 86, 442, 409, 80, 160), (138, 113, 113, 199, 140, 80, 160), (139, 85, 85, 645, 719, 80, 160), (140, 153, 153, 71, 64, 80, 160), (141, 145, 145, 252, 57, 80, 160), (142, 52, 52, 192, 263, 80, 160), (143, 126, 126, 819, 834, 80, 160), (144, 75, 75, 585, 588, 80, 160), (145, 83, 83, 1040, 953, 80, 160), (146, 97, 97, 234, 95, 80, 160), (147, 143, 143, 444, 280, 80, 160), (148, 64, 64, 963, 1015, 80, 160), (149, 134, 134, 694, 502, 80, 160), (150, 87, 87, 748, 812, 80, 160), (151, 137, 137, 572, 438, 80, 160), (152, 90, 90, 223, 133, 80, 160), (153, 57, 57, 973, 849, 80, 160), (154, 133, 133, 397, 405, 80, 160), (155, 92, 92, 777, 842, 80, 160), (156, 52, 52, 789, 837, 80, 160), (157, 143, 143, 645, 435, 80, 160), (158, 112, 112, 304, 182, 80, 160), (159, 108, 108, 467, 457, 80, 160), (160, 57, 57, 524, 598, 80, 160), (161, 149, 149, 1040, 1022, 80, 160), (162, 152, 152, 153, 53, 80, 160), (163, 143, 143, 136, 133, 80, 160), (164, 152, 152, 270, 160, 80, 160), (165, 148, 148, 332, 204, 80, 160), (166, 60, 60, 911, 996, 80, 160), (167, 117, 117, 191, 131, 80, 160), (168, 110, 110, 290, 172, 80, 160), (169, 86, 86, 3, 31, 80, 160), (170, 107, 107, 144, 116, 80, 160), (171, 48, 48, 277, 314, 80, 160), (172, 129, 129, 198, 42, 80, 160), (173, 67, 67, 140, 105, 80, 160), (174, 139, 139, 61, 44, 80, 160), (175, 129, 129, 219, 133, 80, 160), (176, 159, 159, 1034, 926, 80, 160), (177, 158, 158, 638, 454, 80, 160), (178, 94, 94, 47, 50, 80, 160), (179, 55, 55, 346, 258, 80, 160), (180, 61, 61, 919, 929, 80, 160), (181, 42, 42, 199, 290, 80, 160), (182, 57, 57, 742, 649, 80, 160), (183, 53, 53, 28, 4, 80, 160), (184, 48, 48, 525, 488, 80, 160), (185, 153, 153, 427, 259, 80, 160), (186, 53, 53, 585, 674, 80, 160), (187, 89, 89, 400, 261, 80, 160), (188, 120, 120, 854, 699, 80, 160), (189, 101, 101, 629, 492, 80, 160), (190, 121, 121, 399, 306, 80, 160), (191, 131, 131, 131, 89, 80, 160), (192, 116, 116, 611, 448, 80, 160), (193, 90, 90, 77, 2, 80, 160), (194, 145, 145, 441, 384, 80, 160), (195, 55, 55, 622, 666, 80, 160), (196, 155, 155, 103, 97, 80, 160), (197, 63, 63, 67, 24, 80, 160), (198, 85, 85, 924, 854, 80, 160), (199, 71, 71, 819, 774, 80, 160), (200, 51, 51, 854, 910, 80, 160), (201, 110, 110, 28, 17, 80, 160), (202, 66, 66, 1024, 977, 80, 160), (203, 95, 95, 695, 759, 80, 160), (204, 102, 102, 396, 297, 80, 160), (205, 98, 98, 963, 960, 80, 160), (206, 110, 110, 611, 560, 80, 160), (207, 42, 42, 424, 520, 80, 160), (208, 45, 45, 77, 37, 80, 160), (209, 120, 120, 734, 771, 80, 160), (210, 62, 62, 252, 232, 80, 160), (211, 53, 53, 1001, 1000, 80, 160), (212, 81, 81, 252, 200, 80, 160), (213, 138, 138, 346, 176, 80, 160), (214, 58, 58, 332, 232, 80, 160), (215, 69, 69, 219, 177, 80, 160), (216, 69, 69, 53, 2, 80, 160), (217, 155, 155, 71, 12, 80, 160), (218, 104, 104, 638, 600, 80, 160), (219, 117, 117, 60, 61, 80, 160), (220, 104, 104, 443, 496, 80, 160), (221, 128, 128, 683, 609, 80, 160), (222, 149, 149, 1040, 974, 80, 160), (223, 114, 114, 594, 488, 80, 160), (224, 157, 157, 1, 4, 80, 160), (225, 103, 103, 518, 526, 80, 160), (226, 148, 148, 209, 170, 80, 160), (227, 140, 140, 778, 701, 80, 160), (228, 53, 53, 192, 130, 80, 160), (229, 98, 98, 424, 362, 80, 160), (230, 106, 106, 356, 369, 80, 160), (231, 147, 147, 552, 407, 80, 160), (232, 68, 68, 684, 600, 80, 160), (233, 104, 104, 32, 24, 80, 160), (234, 55, 55, 748, 677, 80, 160), (235, 51, 51, 832, 851, 80, 160), (236, 69, 69, 269, 300, 80, 160), (237, 68, 68, 277, 191, 80, 160), (238, 40, 40, 934, 846, 80, 160), (239, 125, 125, 603, 628, 80, 160), (240, 72, 72, 722, 736, 80, 160), (241, 50, 50, 210, 255, 80, 160), (242, 74, 74, 152, 143, 80, 160), (243, 140, 140, 394, 174, 80, 160), (244, 113, 113, 61, 55, 80, 160), (245, 73, 73, 996, 861, 80, 160), (246, 55, 55, 784, 874, 80, 160), (247, 46, 46, 680, 653, 80, 160), (248, 101, 101, 963, 917, 80, 160), (249, 122, 122, 1034, 965, 80, 160), (250, 127, 127, 358, 271, 80, 160), (251, 141, 141, 270, 62, 80, 160), (252, 147, 147, 71, 4, 80, 160), (253, 51, 51, 919, 951, 80, 160), (254, 92, 92, 241, 278, 80, 160), (255, 52, 52, 592, 678, 80, 160), (256, 141, 141, 644, 639, 80, 160), (257, 109, 109, 768, 589, 80, 160), (258, 95, 95, 725, 676, 80, 160), (259, 46, 46, 664, 773, 80, 160), (260, 82, 82, 191, 121, 80, 160), (261, 122, 122, 262, 122, 80, 160), (262, 143, 143, 304, 200, 80, 160), (263, 144, 144, 254, 31, 80, 160), (264, 91, 91, 311, 255, 80, 160), (265, 44, 44, 585, 565, 80, 160), (266, 123, 123, 306, 297, 80, 160), (267, 109, 109, 153, 160, 80, 160), (268, 119, 119, 209, 203, 80, 160), (269, 105, 105, 1012, 957, 80, 160), (270, 45, 45, 10, 90, 80, 160), (271, 153, 153, 219, 24, 80, 160), (272, 74, 74, 895, 871, 80, 160), (273, 47, 47, 552, 553, 80, 160), (274, 73, 73, 61, 40, 80, 160), (275, 133, 133, 1040, 933, 80, 160), (276, 129, 129, 396, 373, 80, 160), (277, 100, 100, 977, 931, 80, 160), (278, 157, 157, 734, 501, 80, 160), (279, 87, 87, 927, 984, 80, 160), (280, 80, 80, 447, 481, 80, 160), (281, 63, 63, 102, 172, 80, 160), (282, 74, 74, 443, 430, 80, 160), (283, 143, 143, 391, 322, 80, 160), (284, 159, 159, 61, 7, 80, 160), (285, 110, 110, 252, 292, 80, 160), (286, 82, 82, 517, 411, 80, 160), (287, 54, 54, 284, 303, 80, 160), (288, 111, 111, 740, 660, 80, 160), (289, 122, 122, 140, 114, 80, 160), (290, 132, 132, 973, 993, 80, 160), (291, 67, 67, 270, 359, 80, 160), (292, 61, 61, 873, 856, 80, 160), (293, 65, 65, 205, 228, 80, 160), (294, 77, 77, 485, 403, 80, 160), (295, 155, 155, 325, 306, 80, 160), (296, 159, 159, 13, 1, 80, 160), (297, 144, 144, 245, 116, 80, 160), (298, 129, 129, 683, 682, 80, 160), (299, 40, 40, 327, 256, 80, 160), (300, 113, 113, 947, 940, 80, 160), (301, 107, 107, 103, 125, 80, 160), (302, 60, 60, 290, 348, 80, 160), (303, 108, 108, 234, 210, 80, 160), (304, 82, 82, 496, 505, 80, 160), (305, 125, 125, 444, 319, 80, 160), (306, 96, 96, 424, 410, 80, 160), (307, 117, 117, 832, 709, 80, 160), (308, 96, 96, 205, 214, 80, 160), (309, 131, 131, 144, 98, 80, 160), (310, 72, 72, 899, 761, 80, 160), (311, 144, 144, 32, 12, 80, 160), (312, 41, 41, 574, 565, 80, 160), (313, 60, 60, 142, 206, 80, 160), (314, 140, 140, 800, 671, 80, 160), (315, 157, 157, 413, 279, 80, 160), (316, 93, 93, 616, 588, 80, 160), (317, 118, 118, 158, 96, 80, 160), (318, 123, 123, 152, 143, 80, 160), (319, 59, 59, 441, 518, 80, 160), (320, 48, 48, 172, 72, 80, 160), (321, 59, 59, 592, 476, 80, 160), (322, 74, 74, 325, 213, 80, 160), (323, 67, 67, 32, 49, 80, 160), (324, 135, 135, 358, 369, 80, 160), (325, 127, 127, 424, 305, 80, 160), (326, 148, 148, 909, 800, 80, 160), (327, 137, 137, 996, 977, 80, 160), (328, 47, 47, 397, 498, 80, 160), (329, 75, 75, 462, 329, 80, 160), (330, 82, 82, 819, 859, 80, 160), (331, 54, 54, 158, 56, 80, 160), (332, 48, 48, 854, 874, 80, 160), (333, 121, 121, 813, 740, 80, 160), (334, 135, 135, 748, 686, 80, 160), (335, 114, 114, 671, 652, 80, 160), (336, 106, 106, 645, 604, 80, 160), (337, 145, 145, 1024, 808, 80, 160), (338, 110, 110, 423, 280, 80, 160), (339, 132, 132, 159, 176, 80, 160), (340, 48, 48, 977, 910, 80, 160), (341, 140, 140, 210, 167, 80, 160), (342, 111, 111, 295, 235, 80, 160), (343, 71, 71, 393, 270, 80, 160), (344, 106, 106, 362, 412, 80, 160), (345, 150, 150, 854, 789, 80, 160), (346, 75, 75, 131, 196, 80, 160), (347, 93, 93, 747, 686, 80, 160), (348, 85, 85, 210, 193, 80, 160), (349, 74, 74, 324, 220, 80, 160), (350, 132, 132, 401, 381, 80, 160), (351, 51, 51, 648, 555, 80, 160), (352, 150, 150, 668, 582, 80, 160), (353, 75, 75, 593, 637, 80, 160), (354, 123, 123, 506, 313, 80, 160), (355, 107, 107, 582, 572, 80, 160), (356, 57, 57, 1015, 1097, 80, 160), (357, 72, 72, 1013, 891, 80, 160), (358, 104, 104, 581, 627, 80, 160), (359, 148, 148, 485, 263, 80, 160), (360, 101, 101, 397, 388, 80, 160), (361, 123, 123, 683, 653, 80, 160), (362, 57, 57, 397, 412, 80, 160), (363, 106, 106, 304, 269, 80, 160), (364, 120, 120, 609, 521, 80, 160), (365, 55, 55, 1034, 1066, 80, 160), (366, 92, 92, 404, 341, 80, 160), (367, 61, 61, 780, 694, 80, 160), (368, 118, 118, 1, 28, 80, 160), (369, 63, 63, 28, 58, 80, 160), (370, 138, 138, 485, 377, 80, 160), (371, 141, 141, 467, 298, 80, 160), (372, 69, 69, 295, 153, 80, 160), (373, 149, 149, 422, 357, 80, 160), (374, 150, 150, 506, 509, 80, 160), (375, 123, 123, 801, 662, 80, 160), (376, 132, 132, 293, 83, 80, 160), (377, 87, 87, 518, 439, 80, 160), (378, 142, 142, 144, 119, 80, 160), (379, 142, 142, 270, 185, 80, 160), (380, 155, 155, 28, 26, 80, 160), (381, 90, 90, 247, 282, 80, 160), (382, 150, 150, 241, 91, 80, 160), (383, 59, 59, 593, 574, 80, 160), (384, 75, 75, 525, 553, 80, 160), (385, 75, 75, 684, 679, 80, 160), (386, 133, 133, 645, 517, 80, 160), (387, 85, 85, 111, 31, 80, 160), (388, 102, 102, 243, 146, 80, 160), (389, 135, 135, 158, 140, 80, 160), (390, 62, 62, 172, 57, 80, 160), (391, 145, 145, 241, 117, 80, 160), (392, 77, 77, 841, 828, 80, 160), (393, 44, 44, 140, 102, 80, 160), (394, 93, 93, 789, 717, 80, 160), (395, 158, 158, 603, 520, 80, 160), (396, 94, 94, 832, 784, 80, 160), (397, 141, 141, 1023, 952, 80, 160), (398, 57, 57, 911, 994, 80, 160), (399, 60, 60, 346, 368, 80, 160), (400, 40, 40, 719, 661, 80, 160), (401, 82, 82, 325, 326, 80, 160), (402, 81, 81, 934, 990, 80, 160), (403, 112, 112, 210, 51, 80, 160), (404, 62, 62, 645, 547, 80, 160), (405, 126, 126, 671, 688, 80, 160), (406, 133, 133, 704, 631, 80, 160), (407, 50, 50, 739, 630, 80, 160), (408, 72, 72, 946, 950, 80, 160), (409, 68, 68, 977, 1063, 80, 160), (410, 95, 95, 748, 807, 80, 160), (411, 133, 133, 362, 275, 80, 160), (412, 144, 144, 337, 269, 80, 160), (413, 63, 63, 11, 58, 80, 160), (414, 159, 159, 1, 0, 80, 160), (415, 102, 102, 423, 477, 80, 160), (416, 105, 105, 152, 112, 80, 160), (417, 80, 80, 290, 217, 80, 160), (418, 153, 153, 525, 325, 80, 160), (419, 46, 46, 311, 236, 80, 160), (420, 132, 132, 1021, 1016, 80, 160), (421, 97, 97, 963, 835, 80, 160), (422, 128, 128, 674, 692, 80, 160), (423, 150, 150, 28, 37, 80, 160), (424, 88, 88, 77, 135, 80, 160), (425, 126, 126, 694, 557, 80, 160), (426, 77, 77, 740, 730, 80, 160), (427, 123, 123, 245, 252, 80, 160), (428, 99, 99, 367, 345, 80, 160), (429, 139, 139, 404, 387, 80, 160), (430, 131, 131, 819, 716, 80, 160), (431, 139, 139, 782, 768, 80, 160), (432, 71, 71, 813, 832, 80, 160), (433, 48, 48, 725, 688, 80, 160), (434, 129, 129, 876, 877, 80, 160), (435, 106, 106, 511, 503, 80, 160), (436, 150, 150, 523, 316, 80, 160), (437, 119, 119, 949, 942, 80, 160), (438, 106, 106, 603, 620, 80, 160), (439, 142, 142, 367, 358, 80, 160), (440, 65, 65, 444, 423, 80, 160), (441, 128, 128, 625, 509, 80, 160), (442, 67, 67, 131, 53, 80, 160), (443, 92, 92, 422, 292, 80, 160), (444, 54, 54, 899, 959, 80, 160), (445, 61, 61, 1015, 926, 80, 160), (446, 114, 114, 629, 665, 80, 160), (447, 155, 155, 778, 665, 80, 160), (448, 152, 152, 783, 614, 80, 160), (449, 157, 157, 262, 136, 80, 160), (450, 124, 124, 346, 144, 80, 160), (451, 78, 78, 473, 370, 80, 160), (452, 95, 95, 332, 363, 80, 160), (453, 99, 99, 60, 118, 80, 160), (454, 117, 117, 183, 193, 80, 160), (455, 98, 98, 674, 567, 80, 160), (456, 152, 152, 1015, 824, 80, 160), (457, 79, 79, 783, 696, 80, 160), (458, 79, 79, 245, 253, 80, 160), (459, 133, 133, 210, 237, 80, 160), (460, 138, 138, 1012, 923, 80, 160), (461, 73, 73, 401, 342, 80, 160), (462, 80, 80, 152, 3, 80, 160), (463, 41, 41, 832, 740, 80, 160), (464, 49, 49, 819, 699, 80, 160), (465, 41, 41, 541, 528, 80, 160), (466, 115, 115, 800, 661, 80, 160), (467, 151, 151, 876, 835, 80, 160), (468, 115, 115, 1034, 1009, 80, 160), (469, 82, 82, 813, 812, 80, 160), (470, 106, 106, 629, 598, 80, 160), (471, 58, 58, 277, 164, 80, 160), (472, 145, 145, 1022, 857, 80, 160), (473, 113, 113, 372, 332, 80, 160), (474, 95, 95, 973, 850, 80, 160), (475, 149, 149, 977, 791, 80, 160), (476, 158, 158, 524, 303, 80, 160), (477, 63, 63, 53, 5, 80, 160), (478, 68, 68, 443, 354, 80, 160), (479, 71, 71, 290, 284, 80, 160), (480, 65, 65, 306, 187, 80, 160), (481, 98, 98, 391, 334, 80, 160), (482, 78, 78, 739, 819, 80, 160), (483, 142, 142, 263, 185, 80, 160), (484, 126, 126, 423, 274, 80, 160), (485, 41, 41, 622, 512, 80, 160), (486, 80, 80, 934, 986, 80, 160), (487, 115, 115, 485, 422, 80, 160), (488, 74, 74, 680, 678, 80, 160), (489, 87, 87, 401, 284, 80, 160), (490, 48, 48, 911, 943, 80, 160), (491, 73, 73, 777, 660, 80, 160), (492, 113, 113, 668, 497, 80, 160), (493, 43, 43, 269, 377, 80, 160), (494, 146, 146, 946, 916, 80, 160), (495, 119, 119, 1040, 923, 80, 160), (496, 119, 119, 517, 318, 80, 160), (497, 122, 122, 147, 82, 80, 160), (498, 71, 71, 973, 905, 80, 160), (499, 123, 123, 346, 275, 80, 160), (500, 114, 114, 977, 887, 80, 160), (501, 129, 129, 262, 154, 80, 160), (502, 54, 54, 674, 611, 80, 160), (503, 146, 146, 683, 621, 80, 160), (504, 75, 75, 648, 625, 80, 160), (505, 42, 42, 668, 598, 80, 160), (506, 153, 153, 625, 407, 80, 160), (507, 48, 48, 772, 679, 80, 160), (508, 116, 116, 277, 112, 80, 160), (509, 143, 143, 325, 154, 80, 160), (510, 84, 84, 911, 983, 80, 160), (511, 60, 60, 1015, 965, 80, 160), (512, 73, 73, 777, 642, 80, 160), (513, 128, 128, 751, 577, 80, 160), (514, 155, 155, 325, 145, 80, 160), (515, 130, 130, 789, 795, 80, 160), (516, 137, 137, 684, 640, 80, 160), (517, 78, 78, 430, 305, 80, 160), (518, 81, 81, 422, 314, 80, 160), (519, 57, 57, 1015, 1075, 80, 160), (520, 145, 145, 304, 269, 80, 160), (521, 49, 49, 523, 590, 80, 160), (522, 74, 74, 447, 387, 80, 160), (523, 61, 61, 821, 840, 80, 160), (524, 53, 53, 16, 8, 80, 160), (525, 148, 148, 592, 595, 80, 160), (526, 147, 147, 524, 457, 80, 160), (527, 93, 93, 1015, 853, 80, 160), (528, 74, 74, 909, 759, 80, 160), (529, 142, 142, 53, 36, 80, 160), (530, 72, 72, 152, 26, 80, 160), (531, 98, 98, 541, 584, 80, 160), (532, 46, 46, 253, 344, 80, 160), (533, 140, 140, 61, 59, 80, 160), (534, 124, 124, 60, 40, 80, 160), (535, 105, 105, 485, 455, 80, 160), (536, 92, 92, 225, 240, 80, 160), (537, 119, 119, 281, 181, 80, 160), (538, 102, 102, 400, 436, 80, 160), (539, 87, 87, 611, 675, 80, 160), (540, 107, 107, 172, 116, 80, 160), (541, 56, 56, 631, 642, 80, 160), (542, 61, 61, 813, 745, 80, 160), (543, 61, 61, 552, 535, 80, 160), (544, 53, 53, 10, 67, 80, 160), (545, 65, 65, 783, 693, 80, 160), (546, 64, 64, 234, 98, 80, 160), (547, 78, 78, 523, 589, 80, 160), (548, 48, 48, 1015, 1053, 80, 160), (549, 70, 70, 919, 1003, 80, 160), (550, 76, 76, 455, 311, 80, 160), (551, 40, 40, 358, 475, 80, 160), (552, 82, 82, 919, 794, 80, 160), (553, 74, 74, 1, 82, 80, 160), (554, 142, 142, 622, 603, 80, 160), (555, 47, 47, 518, 630, 80, 160), (556, 123, 123, 704, 560, 80, 160), (557, 89, 89, 304, 373, 80, 160), (558, 133, 133, 441, 356, 80, 160), (559, 77, 77, 327, 285, 80, 160), (560, 87, 87, 225, 152, 80, 160), (561, 118, 118, 592, 460, 80, 160), (562, 131, 131, 158, 78, 80, 160), (563, 64, 64, 1031, 1029, 80, 160), (564, 140, 140, 594, 605, 80, 160), (565, 54, 54, 263, 191, 80, 160), (566, 52, 52, 509, 528, 80, 160), (567, 116, 116, 234, 246, 80, 160), (568, 81, 81, 243, 232, 80, 160), (569, 156, 156, 592, 477, 80, 160), (570, 121, 121, 427, 456, 80, 160), (571, 72, 72, 60, 125, 80, 160), (572, 114, 114, 1040, 949, 80, 160), (573, 60, 60, 1015, 1019, 80, 160), (574, 150, 150, 947, 804, 80, 160), (575, 57, 57, 1023, 934, 80, 160), (576, 157, 157, 800, 635, 80, 160), (577, 92, 92, 270, 119, 80, 160), (578, 110, 110, 772, 586, 80, 160), (579, 95, 95, 775, 626, 80, 160), (580, 40, 40, 747, 672, 80, 160), (581, 146, 146, 545, 554, 80, 160), (582, 140, 140, 581, 398, 80, 160), (583, 72, 72, 616, 510, 80, 160), (584, 153, 153, 927, 703, 80, 160), (585, 121, 121, 594, 590, 80, 160), (586, 119, 119, 777, 772, 80, 160), (587, 152, 152, 924, 824, 80, 160), (588, 80, 80, 739, 624, 80, 160), (589, 53, 53, 190, 138, 80, 160), (590, 72, 72, 517, 462, 80, 160), (591, 65, 65, 778, 637, 80, 160), (592, 122, 122, 247, 107, 80, 160), (593, 119, 119, 1001, 872, 80, 160), (594, 133, 133, 422, 438, 80, 160), (595, 85, 85, 747, 787, 80, 160), (596, 57, 57, 191, 246, 80, 160), (597, 149, 149, 372, 341, 80, 160), (598, 60, 60, 870, 825, 80, 160), (599, 143, 143, 397, 191, 80, 160), (600, 91, 91, 870, 797, 80, 160), (601, 60, 60, 291, 217, 80, 160), (602, 111, 111, 243, 277, 80, 160), (603, 102, 102, 431, 282, 80, 160), (604, 68, 68, 739, 705, 80, 160), (605, 112, 112, 506, 394, 80, 160), (606, 52, 52, 585, 667, 80, 160), (607, 145, 145, 742, 613, 80, 160), (608, 128, 128, 854, 652, 80, 160), (609, 81, 81, 102, 88, 80, 160), (610, 105, 105, 293, 262, 80, 160), (611, 107, 107, 725, 751, 80, 160), (612, 50, 50, 899, 887, 80, 160), (613, 64, 64, 28, 32, 80, 160), (614, 69, 69, 784, 682, 80, 160), (615, 106, 106, 1024, 1046, 80, 160), (616, 51, 51, 225, 127, 80, 160), (617, 101, 101, 841, 882, 80, 160), (618, 126, 126, 60, 81, 80, 160), (619, 89, 89, 698, 665, 80, 160), (620, 66, 66, 870, 852, 80, 160), (621, 142, 142, 947, 736, 80, 160), (622, 96, 96, 919, 975, 80, 160), (623, 122, 122, 362, 380, 80, 160), (624, 137, 137, 422, 383, 80, 160), (625, 45, 45, 103, 60, 80, 160), (626, 141, 141, 47, 50, 80, 160), (627, 96, 96, 387, 213, 80, 160), (628, 143, 143, 895, 755, 80, 160), (629, 59, 59, 60, 126, 80, 160), (630, 73, 73, 367, 326, 80, 160), (631, 49, 49, 671, 660, 80, 160), (632, 122, 122, 198, 28, 80, 160), (633, 128, 128, 401, 340, 80, 160), (634, 87, 87, 102, 162, 80, 160), (635, 156, 156, 611, 435, 80, 160), (636, 138, 138, 1, 16, 80, 160), (637, 114, 114, 722, 765, 80, 160), (638, 92, 92, 391, 390, 80, 160), (639, 160, 160, 582, 409, 80, 160), (640, 51, 51, 192, 292, 80, 160), (641, 64, 64, 293, 382, 80, 160), (642, 51, 51, 924, 847, 80, 160), (643, 133, 133, 444, 251, 80, 160), (644, 54, 54, 841, 783, 80, 160), (645, 69, 69, 427, 391, 80, 160), (646, 40, 40, 648, 668, 80, 160), (647, 114, 114, 821, 863, 80, 160), (648, 125, 125, 304, 289, 80, 160), (649, 109, 109, 484, 312, 80, 160), (650, 93, 93, 158, 57, 80, 160), (651, 155, 155, 159, 21, 80, 160), (652, 55, 55, 953, 986, 80, 160), (653, 139, 139, 424, 205, 80, 160), (654, 53, 53, 512, 548, 80, 160), (655, 106, 106, 523, 471, 80, 160), (656, 72, 72, 704, 757, 80, 160), (657, 55, 55, 841, 859, 80, 160), (658, 131, 131, 734, 654, 80, 160), (659, 79, 79, 739, 759, 80, 160), (660, 158, 158, 192, 192, 80, 160), (661, 99, 99, 616, 542, 80, 160), (662, 121, 121, 140, 160, 80, 160), (663, 103, 103, 387, 340, 80, 160), (664, 80, 80, 216, 211, 80, 160), (665, 50, 50, 631, 583, 80, 160), (666, 64, 64, 722, 783, 80, 160), (667, 41, 41, 645, 736, 80, 160), (668, 112, 112, 625, 457, 80, 160), (669, 120, 120, 698, 587, 80, 160), (670, 99, 99, 977, 911, 80, 160), (671, 59, 59, 46, 50, 80, 160), (672, 73, 73, 585, 454, 80, 160), (673, 117, 117, 841, 837, 80, 160), (674, 151, 151, 496, 375, 80, 160), (675, 109, 109, 346, 371, 80, 160), (676, 120, 120, 219, 258, 80, 160), (677, 126, 126, 484, 313, 80, 160), (678, 54, 54, 28, 120, 80, 160), (679, 118, 118, 423, 301, 80, 160), (680, 100, 100, 629, 683, 80, 160), (681, 126, 126, 61, 43, 80, 160), (682, 64, 64, 423, 365, 80, 160), (683, 103, 103, 1001, 1029, 80, 160), (684, 91, 91, 71, 79, 80, 160), (685, 149, 149, 722, 721, 80, 160), (686, 77, 77, 748, 815, 80, 160), (687, 53, 53, 245, 112, 80, 160), (688, 97, 97, 94, 90, 80, 160), (689, 115, 115, 443, 285, 80, 160), (690, 93, 93, 216, 176, 80, 160), (691, 73, 73, 391, 377, 80, 160), (692, 130, 130, 473, 303, 80, 160), (693, 157, 157, 934, 923, 80, 160), (694, 70, 70, 223, 310, 80, 160), (695, 144, 144, 919, 826, 80, 160), (696, 68, 68, 281, 138, 80, 160), (697, 79, 79, 638, 516, 80, 160), (698, 110, 110, 28, 56, 80, 160), (699, 154, 154, 511, 513, 80, 160), (700, 82, 82, 895, 748, 80, 160), (701, 55, 55, 919, 1016, 80, 160), (702, 87, 87, 53, 97, 80, 160), (703, 77, 77, 192, 49, 80, 160), (704, 87, 87, 281, 195, 80, 160), (705, 124, 124, 751, 552, 80, 160), (706, 120, 120, 887, 793, 80, 160), (707, 100, 100, 253, 295, 80, 160), (708, 112, 112, 270, 116, 80, 160), (709, 130, 130, 772, 684, 80, 160), (710, 83, 83, 136, 37, 80, 160), (711, 110, 110, 909, 721, 80, 160), (712, 120, 120, 241, 254, 80, 160), (713, 121, 121, 927, 827, 80, 160), (714, 55, 55, 680, 621, 80, 160), (715, 106, 106, 772, 699, 80, 160), (716, 72, 72, 506, 473, 80, 160), (717, 153, 153, 356, 200, 80, 160), (718, 60, 60, 545, 605, 80, 160), (719, 136, 136, 876, 825, 80, 160), (720, 119, 119, 216, 87, 80, 160), (721, 66, 66, 46, 112, 80, 160), (722, 85, 85, 973, 954, 80, 160), (723, 56, 56, 404, 280, 80, 160), (724, 90, 90, 772, 651, 80, 160), (725, 156, 156, 442, 394, 80, 160), (726, 47, 47, 293, 368, 80, 160), (727, 70, 70, 1031, 937, 80, 160), (728, 104, 104, 391, 223, 80, 160), (729, 93, 93, 1001, 997, 80, 160), (730, 80, 80, 512, 563, 80, 160), (731, 78, 78, 500, 400, 80, 160), (732, 72, 72, 948, 976, 80, 160), (733, 90, 90, 393, 421, 80, 160), (734, 40, 40, 668, 682, 80, 160), (735, 121, 121, 252, 291, 80, 160), (736, 129, 129, 780, 745, 80, 160), (737, 50, 50, 293, 326, 80, 160), (738, 116, 116, 397, 389, 80, 160), (739, 142, 142, 694, 698, 80, 160), (740, 65, 65, 304, 301, 80, 160), (741, 160, 160, 644, 410, 80, 160), (742, 83, 83, 6, 45, 80, 160), (743, 109, 109, 293, 206, 80, 160), (744, 43, 43, 210, 318, 80, 160), (745, 67, 67, 423, 306, 80, 160), (746, 75, 75, 284, 343, 80, 160), (747, 123, 123, 423, 295, 80, 160), (748, 133, 133, 404, 267, 80, 160), (749, 72, 72, 103, 44, 80, 160), (750, 158, 158, 582, 344, 80, 160), (751, 150, 150, 387, 206, 80, 160), (752, 129, 129, 956, 835, 80, 160), (753, 95, 95, 47, 55, 80, 160), (754, 113, 113, 462, 453, 80, 160), (755, 75, 75, 640, 648, 80, 160), (756, 47, 47, 304, 380, 80, 160), (757, 123, 123, 254, 139, 80, 160), (758, 136, 136, 281, 212, 80, 160), (759, 52, 52, 421, 478, 80, 160), (760, 102, 102, 988, 915, 80, 160), (761, 86, 86, 346, 253, 80, 160), (762, 69, 69, 775, 750, 80, 160), (763, 58, 58, 664, 622, 80, 160), (764, 82, 82, 980, 977, 80, 160), (765, 141, 141, 609, 432, 80, 160), (766, 98, 98, 640, 662, 80, 160), (767, 160, 160, 485, 325, 80, 160), (768, 46, 46, 131, 51, 80, 160), (769, 100, 100, 594, 576, 80, 160), (770, 60, 60, 397, 463, 80, 160), (771, 71, 71, 927, 785, 80, 160), (772, 158, 158, 270, 186, 80, 160), (773, 89, 89, 460, 475, 80, 160), (774, 108, 108, 552, 384, 80, 160), (775, 102, 102, 447, 473, 80, 160), (776, 132, 132, 344, 178, 80, 160), (777, 68, 68, 854, 762, 80, 160), (778, 151, 151, 462, 456, 80, 160), (779, 105, 105, 600, 438, 80, 160), (780, 128, 128, 462, 331, 80, 160), (781, 156, 156, 172, 148, 80, 160), (782, 146, 146, 876, 887, 80, 160), (783, 72, 72, 496, 478, 80, 160), (784, 84, 84, 183, 110, 80, 160), (785, 146, 146, 500, 287, 80, 160), (786, 85, 85, 61, 8, 80, 160), (787, 86, 86, 1023, 928, 80, 160), (788, 106, 106, 1031, 939, 80, 160), (789, 138, 138, 719, 680, 80, 160), (790, 91, 91, 1024, 954, 80, 160), (791, 103, 103, 324, 227, 80, 160), (792, 55, 55, 832, 717, 80, 160), (793, 157, 157, 518, 441, 80, 160), (794, 140, 140, 623, 540, 80, 160), (795, 149, 149, 552, 405, 80, 160), (796, 84, 84, 152, 175, 80, 160), (797, 127, 127, 948, 896, 80, 160), (798, 130, 130, 772, 608, 80, 160), (799, 95, 95, 183, 83, 80, 160), (800, 148, 148, 523, 363, 80, 160)
], dtype=Job)
    
    seeds = [1415, 9265, 3589, 7932, 3846, 2643, 3832, 7950, 2884, 1971, 6939, 9375, 1058, 2097, 4944, 5923, 781, 6406, 2862, 899, 8628, 348, 2534, 2117, 679, 8214, 8086, 5132, 8230, 6647, 938, 4460]
    c_t = 8100
    max_time = max(job['due_date'] + job['upper_bound'] for job in jobs)
    max_iterations = 500000000000000
    # List of different stagnant move values
    max_iterations_list = [2500000, 5000000, 7500000, 9500000, 11700000]


    for max_iterations in max_iterations_list:
        objective_values = []
        durations_list = []

        for i in range(32):
            start_time = time.time()
            best_objective = simplified_random_local_search(jobs, c_t, max_time, max_iterations, seeds[i])
            duration = time.time() - start_time

            if i > 1:  # Skip the first run used for JIT compilation
                objective_values.append(best_objective)
                durations_list.append(duration)

        # Calculate summary statistics for the last 30 runs
        if objective_values:  # Ensure there are valid results
            mean_objective = np.mean(objective_values)
            std_dev_objective = np.std(objective_values)
            min_objective = np.min(objective_values)
            max_objective = np.max(objective_values)
            q1_objective = np.percentile(objective_values, 25)
            q3_objective = np.percentile(objective_values, 75)
            average_duration = np.mean(durations_list)

            # Print summary for the current configuration
            print("\nSummary for Max Iterations = ", max_iterations)
            print(f"Mean Objective Value: {mean_objective:.2f}")
            print(f"Standard Deviation: {std_dev_objective:.2f}")
            print(f"Minimum Objective Value: {min_objective:.2f}")
            print(f"Maximum Objective Value: {max_objective:.2f}")
            print(f"Q1 Objective (25th percentile): {q1_objective:.2f}")
            print(f"Q3 Objective (75th percentile): {q3_objective:.2f}")
            print(f"Average Duration: {average_duration:.3f} seconds")


if __name__ == '__main__':
    main()